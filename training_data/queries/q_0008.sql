SELECT L_AIRPORT_SEQ_ID.Code, L_AIRPORT_SEQ_ID.Description, ROW_NUMBER() OVER (PARTITION BY L_AIRPORT_SEQ_ID.Code ORDER BY L_AIRPORT_SEQ_ID.Description) AS win_2, AVG(L_AIRPORT_SEQ_ID.Code) OVER (PARTITION BY L_AIRPORT_SEQ_ID.Description ORDER BY L_AIRPORT_SEQ_ID.Description) AS win_3, ROW_NUMBER() OVER (PARTITION BY L_AIRPORT_SEQ_ID.Code ORDER BY L_AIRPORT_SEQ_ID.Code) AS win_4 FROM L_AIRPORT_SEQ_ID WHERE (L_AIRPORT_SEQ_ID.Code < 10000000 OR L_AIRPORT_SEQ_ID.Code IS NULL)